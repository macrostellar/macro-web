{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/sarahasif/Documents/Software%20Codes/my-tracking%20app/components/AddDriverModal.tsx"],"sourcesContent":["\"use client\";\nimport { useState } from \"react\";\nimport { X } from \"lucide-react\";\nimport { supabase } from \"../lib/supabase\";\nimport { useAuth } from \"../contexts/AuthContext\";\n\nexport default function AddDriverModal({ onClose, onSuccess }) {\n  const { user } = useAuth();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n\n  const [formData, setFormData] = useState({\n    full_name: \"\",\n    phone_number: \"\",\n    email: \"\",\n    license_number: \"\",\n    license_expiry: \"\",\n    driverImageFile: null,\n    licenseImageFile: null,\n  });\n\n  // --- FIXED: now returns the PUBLIC URL ---\n  const uploadFile = async (file: File, path: string) => {\n  const { error } = await supabase.storage\n    .from(\"driver-files\")\n    .upload(path, file, {\n      upsert: true,\n      contentType: file.type,\n    });\n\n  if (error) {\n    console.error(\"Upload failed:\", error);\n    return null;\n  }\n\n  return path; // return file path to store in DB\n};\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError(\"\");\n    setLoading(true);\n\n    if (!user) return;\n\n    try {\n      const driverId = crypto.randomUUID();\n\n      // Get company_id from profile\n      const { data: profile } = await supabase\n        .from('profiles')\n        .select('company_id')\n        .eq('id', user.id)\n        .maybeSingle();\n\n      const companyId = profile?.company_id ?? user.id;\n\n      let driverImageUrl = \"\"; \n      let licenseImageUrl = \"\";\n\n      // Upload Driver Photo\n      if (formData.driverImageFile) {\n        driverImageUrl = await uploadFile (formData.driverImageFile, `${driverId}/driver.jpg`\n        );\n\n      }\n\n      // Upload License Photo\n      if (formData.licenseImageFile) {\n        licenseImageUrl = await uploadFile(\nformData.licenseImageFile, `${driverId}/license.jpg`\n        );\n      }\n\n      // Insert into table\n      const { error: insertError } = await supabase.from(\"drivers\").insert({\n        id: driverId,\n        user_id: user.id,\n        company_id: companyId,\n        full_name: formData.full_name,\n        phone_number: formData.phone_number,\n        email: formData.email || null,\n        license_number: formData.license_number || null,\n        license_expiry: formData.license_expiry || null,\n        driver_image: driverImageUrl,    // now full URL\n        license_image: licenseImageUrl,  // full URL\n        status: \"active\",\n      });\n\n      if (insertError) throw insertError;\n\n      onSuccess();\n    } catch (err) {\n      console.error(err);\n      setError(err.message || \"Failed to add owner\");\n    }\n\n    setLoading(false);\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl max-w-lg w-full\">\n        \n        {/* Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-slate-700\">\n          <h2 className=\"text-2xl font-bold text-white\">Add New Owner</h2>\n          <button\n            onClick={onClose}\n            className=\"text-slate-400 hover:text-white transition-colors\"\n          >\n            <X className=\"w-6 h-6\" />\n          </button>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n          \n          {error && (\n            <div className=\"bg-red-500/10 border border-red-500/50 rounded-lg p-3\">\n              <p className=\"text-red-400 text-sm\">{error}</p>\n            </div>\n          )}\n\n          {/* Full Name */}\n          <div>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              Full Name *\n            </label>\n            <input\n              type=\"text\"\n              required\n              value={formData.full_name}\n              onChange={(e) =>\n                setFormData({ ...formData, full_name: e.target.value })\n              }\n              className=\"w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white\"\n            />\n          </div>\n\n          {/* Phone Number */}\n          <div>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              Phone Number *\n            </label>\n            <input\n              type=\"text\"\n              required\n              value={formData.phone_number}\n              onChange={(e) =>\n                setFormData({ ...formData, phone_number: e.target.value })\n              }\n              className=\"w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white\"\n            />\n          </div>\n\n          {/* Email */}\n          <div>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              Email (optional)\n            </label>\n            <input\n              type=\"email\"\n              value={formData.email}\n              onChange={(e) =>\n                setFormData({ ...formData, email: e.target.value })\n              }\n              className=\"w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white\"\n            />\n          </div>\n\n          {/* License Number */}\n          {/* <div>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              License Number\n            </label>\n            <input\n              type=\"text\"\n              value={formData.license_number}\n              onChange={(e) =>\n                setFormData({ ...formData, license_number: e.target.value })\n              }\n              className=\"w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white\"\n            />\n          </div> */}\n\n          {/* License Expiry */}\n          {/* <div>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              License Expiry\n            </label>\n            <input\n              type=\"date\"\n              value={formData.license_expiry}\n              onChange={(e) =>\n                setFormData({ ...formData, license_expiry: e.target.value })\n              }\n              className=\"w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white\"\n            />\n          </div> */}\n\n          {/* Driver Photo */}\n          <div>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              Owner Photo\n            </label>\n            <input\n              type=\"file\"\n              accept=\"image/*\"\n              onChange={(e) =>\n                setFormData({\n                  ...formData,\n                  driverImageFile: e.target.files[0],\n                })\n              }\n              className=\"w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white\"\n            />\n          </div>\n\n          {/* License Photo */}\n          {/* <div>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              License Photo\n            </label>\n            <input\n              type=\"file\"\n              accept=\"image/*\"\n              onChange={(e) =>\n                setFormData({\n                  ...formData,\n                  licenseImageFile: e.target.files[0],\n                })\n              }\n              className=\"w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white\"\n            />\n          </div> */}\n\n          <div className=\"flex gap-3 pt-4\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"flex-1 px-4 py-2 bg-slate-700 text-white rounded-lg\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg\"\n            >\n              {loading ? \"Adding...\" : \"Add Owner\"}\n            </button>\n          </div>\n\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AAJA;;;;;;AAMe,SAAS,eAAe,EAAE,OAAO,EAAE,SAAS,EAAE;IAC3D,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,mIAAO;IACxB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IAEnC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;QACvC,WAAW;QACX,cAAc;QACd,OAAO;QACP,gBAAgB;QAChB,gBAAgB;QAChB,iBAAiB;QACjB,kBAAkB;IACpB;IAEA,4CAA4C;IAC5C,MAAM,aAAa,OAAO,MAAY;QACtC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,2HAAQ,CAAC,OAAO,CACrC,IAAI,CAAC,gBACL,MAAM,CAAC,MAAM,MAAM;YAClB,QAAQ;YACR,aAAa,KAAK,IAAI;QACxB;QAEF,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,kBAAkB;YAChC,OAAO;QACT;QAEA,OAAO,MAAM,kCAAkC;IACjD;IAEE,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAChB,SAAS;QACT,WAAW;QAEX,IAAI,CAAC,MAAM;QAEX,IAAI;YACF,MAAM,WAAW,OAAO,UAAU;YAElC,8BAA8B;YAC9B,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,2HAAQ,CACrC,IAAI,CAAC,YACL,MAAM,CAAC,cACP,EAAE,CAAC,MAAM,KAAK,EAAE,EAChB,WAAW;YAEd,MAAM,YAAY,SAAS,cAAc,KAAK,EAAE;YAEhD,IAAI,iBAAiB;YACrB,IAAI,kBAAkB;YAEtB,sBAAsB;YACtB,IAAI,SAAS,eAAe,EAAE;gBAC5B,iBAAiB,MAAM,WAAY,SAAS,eAAe,EAAE,GAAG,SAAS,WAAW,CAAC;YAGvF;YAEA,uBAAuB;YACvB,IAAI,SAAS,gBAAgB,EAAE;gBAC7B,kBAAkB,MAAM,WAChC,SAAS,gBAAgB,EAAE,GAAG,SAAS,YAAY,CAAC;YAE9C;YAEA,oBAAoB;YACpB,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,2HAAQ,CAAC,IAAI,CAAC,WAAW,MAAM,CAAC;gBACnE,IAAI;gBACJ,SAAS,KAAK,EAAE;gBAChB,YAAY;gBACZ,WAAW,SAAS,SAAS;gBAC7B,cAAc,SAAS,YAAY;gBACnC,OAAO,SAAS,KAAK,IAAI;gBACzB,gBAAgB,SAAS,cAAc,IAAI;gBAC3C,gBAAgB,SAAS,cAAc,IAAI;gBAC3C,cAAc;gBACd,eAAe;gBACf,QAAQ;YACV;YAEA,IAAI,aAAa,MAAM;YAEvB;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC;YACd,SAAS,IAAI,OAAO,IAAI;QAC1B;QAEA,WAAW;IACb;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BAGb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAgC;;;;;;sCAC9C,8OAAC;4BACC,SAAS;4BACT,WAAU;sCAEV,cAAA,8OAAC,iMAAC;gCAAC,WAAU;;;;;;;;;;;;;;;;;8BAIjB,8OAAC;oBAAK,UAAU;oBAAc,WAAU;;wBAErC,uBACC,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC;gCAAE,WAAU;0CAAwB;;;;;;;;;;;sCAKzC,8OAAC;;8CACC,8OAAC;oCAAM,WAAU;8CAAgD;;;;;;8CAGjE,8OAAC;oCACC,MAAK;oCACL,QAAQ;oCACR,OAAO,SAAS,SAAS;oCACzB,UAAU,CAAC,IACT,YAAY;4CAAE,GAAG,QAAQ;4CAAE,WAAW,EAAE,MAAM,CAAC,KAAK;wCAAC;oCAEvD,WAAU;;;;;;;;;;;;sCAKd,8OAAC;;8CACC,8OAAC;oCAAM,WAAU;8CAAgD;;;;;;8CAGjE,8OAAC;oCACC,MAAK;oCACL,QAAQ;oCACR,OAAO,SAAS,YAAY;oCAC5B,UAAU,CAAC,IACT,YAAY;4CAAE,GAAG,QAAQ;4CAAE,cAAc,EAAE,MAAM,CAAC,KAAK;wCAAC;oCAE1D,WAAU;;;;;;;;;;;;sCAKd,8OAAC;;8CACC,8OAAC;oCAAM,WAAU;8CAAgD;;;;;;8CAGjE,8OAAC;oCACC,MAAK;oCACL,OAAO,SAAS,KAAK;oCACrB,UAAU,CAAC,IACT,YAAY;4CAAE,GAAG,QAAQ;4CAAE,OAAO,EAAE,MAAM,CAAC,KAAK;wCAAC;oCAEnD,WAAU;;;;;;;;;;;;sCAmCd,8OAAC;;8CACC,8OAAC;oCAAM,WAAU;8CAAgD;;;;;;8CAGjE,8OAAC;oCACC,MAAK;oCACL,QAAO;oCACP,UAAU,CAAC,IACT,YAAY;4CACV,GAAG,QAAQ;4CACX,iBAAiB,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE;wCACpC;oCAEF,WAAU;;;;;;;;;;;;sCAsBd,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCACC,MAAK;oCACL,SAAS;oCACT,WAAU;8CACX;;;;;;8CAGD,8OAAC;oCACC,MAAK;oCACL,UAAU;oCACV,WAAU;8CAET,UAAU,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQvC"}},
    {"offset": {"line": 311, "column": 0}, "map": {"version":3,"sources":["file:///Users/sarahasif/Documents/Software%20Codes/my-tracking%20app/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\n// Format relative time (e.g., \"5 min ago\")\nexport function formatRelativeTime(dateString: string | null | undefined): string {\n  if (!dateString) return \"Unknown\";\n  \n  const date = new Date(dateString);\n  const now = new Date();\n  const diffMs = now.getTime() - date.getTime();\n  const diffSec = Math.floor(diffMs / 1000);\n  const diffMin = Math.floor(diffSec / 60);\n  const diffHour = Math.floor(diffMin / 60);\n  const diffDay = Math.floor(diffHour / 24);\n\n  if (diffSec < 60) return \"Just now\";\n  if (diffMin < 60) return `${diffMin} min ago`;\n  if (diffHour < 24) return `${diffHour} hr ago`;\n  if (diffDay < 7) return `${diffDay} day${diffDay > 1 ? 's' : ''} ago`;\n  \n  return date.toLocaleDateString();\n}\n\n// Debounce function for search inputs\nexport function debounce<T extends (...args: any[]) => any>(\n  func: T,\n  wait: number\n): (...args: Parameters<T>) => void {\n  let timeoutId: NodeJS.Timeout | null = null;\n  \n  return (...args: Parameters<T>) => {\n    if (timeoutId) clearTimeout(timeoutId);\n    timeoutId = setTimeout(() => func(...args), wait);\n  };\n}\n\n// Throttle function for frequent updates\nexport function throttle<T extends (...args: any[]) => any>(\n  func: T,\n  limit: number\n): (...args: Parameters<T>) => void {\n  let inThrottle = false;\n  \n  return (...args: Parameters<T>) => {\n    if (!inThrottle) {\n      func(...args);\n      inThrottle = true;\n      setTimeout(() => (inThrottle = false), limit);\n    }\n  };\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,sKAAO,EAAC,IAAA,6IAAI,EAAC;AACtB;AAGO,SAAS,mBAAmB,UAAqC;IACtE,IAAI,CAAC,YAAY,OAAO;IAExB,MAAM,OAAO,IAAI,KAAK;IACtB,MAAM,MAAM,IAAI;IAChB,MAAM,SAAS,IAAI,OAAO,KAAK,KAAK,OAAO;IAC3C,MAAM,UAAU,KAAK,KAAK,CAAC,SAAS;IACpC,MAAM,UAAU,KAAK,KAAK,CAAC,UAAU;IACrC,MAAM,WAAW,KAAK,KAAK,CAAC,UAAU;IACtC,MAAM,UAAU,KAAK,KAAK,CAAC,WAAW;IAEtC,IAAI,UAAU,IAAI,OAAO;IACzB,IAAI,UAAU,IAAI,OAAO,GAAG,QAAQ,QAAQ,CAAC;IAC7C,IAAI,WAAW,IAAI,OAAO,GAAG,SAAS,OAAO,CAAC;IAC9C,IAAI,UAAU,GAAG,OAAO,GAAG,QAAQ,IAAI,EAAE,UAAU,IAAI,MAAM,GAAG,IAAI,CAAC;IAErE,OAAO,KAAK,kBAAkB;AAChC;AAGO,SAAS,SACd,IAAO,EACP,IAAY;IAEZ,IAAI,YAAmC;IAEvC,OAAO,CAAC,GAAG;QACT,IAAI,WAAW,aAAa;QAC5B,YAAY,WAAW,IAAM,QAAQ,OAAO;IAC9C;AACF;AAGO,SAAS,SACd,IAAO,EACP,KAAa;IAEb,IAAI,aAAa;IAEjB,OAAO,CAAC,GAAG;QACT,IAAI,CAAC,YAAY;YACf,QAAQ;YACR,aAAa;YACb,WAAW,IAAO,aAAa,OAAQ;QACzC;IACF;AACF"}},
    {"offset": {"line": 364, "column": 0}, "map": {"version":3,"sources":["file:///Users/sarahasif/Documents/Software%20Codes/my-tracking%20app/components/ui/Skeleton.tsx"],"sourcesContent":["\"use client\";\n\nimport { cn } from \"@/lib/utils\";\n\ninterface SkeletonProps {\n  className?: string;\n}\n\nexport function Skeleton({ className }: SkeletonProps) {\n  return (\n    <div\n      className={cn(\n        \"animate-pulse rounded-md bg-slate-700/50\",\n        className\n      )}\n    />\n  );\n}\n\nexport function CardSkeleton() {\n  return (\n    <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-6\">\n      <div className=\"flex items-center gap-4 mb-4\">\n        <Skeleton className=\"h-12 w-12 rounded-lg\" />\n        <div className=\"flex-1\">\n          <Skeleton className=\"h-4 w-24 mb-2\" />\n          <Skeleton className=\"h-3 w-16\" />\n        </div>\n        <Skeleton className=\"h-6 w-16 rounded-full\" />\n      </div>\n      <Skeleton className=\"h-3 w-full mb-2\" />\n      <Skeleton className=\"h-3 w-3/4\" />\n    </div>\n  );\n}\n\nexport function TableRowSkeleton() {\n  return (\n    <div className=\"flex items-center gap-4 p-4 border-b border-slate-700\">\n      <Skeleton className=\"h-10 w-10 rounded-full\" />\n      <div className=\"flex-1\">\n        <Skeleton className=\"h-4 w-32 mb-1\" />\n        <Skeleton className=\"h-3 w-24\" />\n      </div>\n      <Skeleton className=\"h-6 w-20 rounded-full\" />\n      <Skeleton className=\"h-8 w-8 rounded\" />\n    </div>\n  );\n}\n\nexport function DashboardSkeleton() {\n  return (\n    <div className=\"p-8\">\n      <div className=\"mb-8\">\n        <Skeleton className=\"h-8 w-64 mb-2\" />\n        <Skeleton className=\"h-4 w-48\" />\n      </div>\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8\">\n        <CardSkeleton />\n        <CardSkeleton />\n      </div>\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8\">\n        <CardSkeleton />\n        <CardSkeleton />\n        <CardSkeleton />\n        <CardSkeleton />\n      </div>\n    </div>\n  );\n}\n\nexport function MapSkeleton() {\n  return (\n    <div className=\"h-full w-full bg-slate-800 animate-pulse flex items-center justify-center\">\n      <div className=\"text-center\">\n        <Skeleton className=\"h-16 w-16 rounded-full mx-auto mb-4\" />\n        <Skeleton className=\"h-4 w-32 mx-auto\" />\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;AAEA;AAFA;;;AAQO,SAAS,SAAS,EAAE,SAAS,EAAiB;IACnD,qBACE,8OAAC;QACC,WAAW,IAAA,kHAAE,EACX,4CACA;;;;;;AAIR;AAEO,SAAS;IACd,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAS,WAAU;;;;;;kCACpB,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAS,WAAU;;;;;;0CACpB,8OAAC;gCAAS,WAAU;;;;;;;;;;;;kCAEtB,8OAAC;wBAAS,WAAU;;;;;;;;;;;;0BAEtB,8OAAC;gBAAS,WAAU;;;;;;0BACpB,8OAAC;gBAAS,WAAU;;;;;;;;;;;;AAG1B;AAEO,SAAS;IACd,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAS,WAAU;;;;;;0BACpB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAS,WAAU;;;;;;kCACpB,8OAAC;wBAAS,WAAU;;;;;;;;;;;;0BAEtB,8OAAC;gBAAS,WAAU;;;;;;0BACpB,8OAAC;gBAAS,WAAU;;;;;;;;;;;;AAG1B;AAEO,SAAS;IACd,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAS,WAAU;;;;;;kCACpB,8OAAC;wBAAS,WAAU;;;;;;;;;;;;0BAEtB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;;;;kCACD,8OAAC;;;;;;;;;;;0BAEH,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;;;;kCACD,8OAAC;;;;;kCACD,8OAAC;;;;;kCACD,8OAAC;;;;;;;;;;;;;;;;;AAIT;AAEO,SAAS;IACd,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAS,WAAU;;;;;;8BACpB,8OAAC;oBAAS,WAAU;;;;;;;;;;;;;;;;;AAI5B"}},
    {"offset": {"line": 634, "column": 0}, "map": {"version":3,"sources":["file:///Users/sarahasif/Documents/Software%20Codes/my-tracking%20app/app/%28dashboard%29/owners/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState, useCallback } from 'react';\nimport { Trash2 } from 'lucide-react';\nimport { supabase } from '../../../lib/supabase';\nimport { useAuth } from '../../../contexts/AuthContext';\nimport { useRouter } from 'next/navigation';\nimport AddDriverModal from '../../../components/AddDriverModal';\nimport { Database } from '@/lib/database.types';\nimport { TableRowSkeleton } from '@/components/ui/Skeleton';\n\nexport default function DriversPage() {\n  const { user } = useAuth();\n  const router = useRouter();\n  const [drivers, setDrivers] = useState<Database[\"public\"][\"Tables\"][\"drivers\"][\"Row\"][]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filteredDrivers, setFilteredDrivers] = useState<Database[\"public\"][\"Tables\"][\"drivers\"][\"Row\"][]>([]);\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [editingDriverId, setEditingDriverId] = useState<string | null>(null);\n\n  // const fetchDrivers = async () => {\n  //   if (!user) return;\n  //   const { data, error } = await supabase\n  //     .from('drivers')\n  //     .select('*')\n  //     .eq('user_id', user.id)\n  //     .order('created_at', { ascending: false });\n\n  //   if (data && !error) {\n  //     setDrivers(data);\n  //     setFilteredDrivers(data);\n  //   }\n\n  //   setLoading(false);\n  // };\nconst fetchDrivers = async () => {\n  if (!user) return;\n\n  // Get the profile data to use company_id and role\n  const { data: profile, error: profileError } = await supabase\n    .from('profiles')\n    .select('company_id, role')\n    .eq('id', user.id)\n    .single();\n\n  if (profileError) {\n    console.error(\"Error fetching profile:\", profileError);\n    return;\n  }\n\n  let query = supabase\n    .from('drivers')\n    .select('*')\n    .order('created_at', { ascending: false });\n\n  if (profile.role === 'super_admin') {\n    console.log(\"Super admin: fetching ALL drivers\");\n    // No filter - show all drivers\n  } else if (profile.company_id) {\n    console.log(\"Owner: fetching drivers for company:\", profile.company_id);\n    query = query.eq('company_id', profile.company_id);\n  } else {\n    console.log(\"Fallback: fetching drivers for user:\", user.id);\n    query = query.eq('user_id', user.id);\n  }\n\n  const { data, error } = await query;\n\n  if (data && !error) {\n    setDrivers(data);\n    setFilteredDrivers(data);\n  } else {\n    console.error(\"Error fetching drivers:\", error);\n  }\n\n  setLoading(false);\n};\n\n  useEffect(() => {\n    fetchDrivers();\n  }, [user]);\n\n  useEffect(() => {\n    let filtered = drivers;\n\n    if (searchTerm) {\n      filtered = filtered.filter(\n        (d) =>\n          (d.full_name?.toLowerCase() || \"\").includes(searchTerm.toLowerCase()) ||\n          (d.phone_number?.toLowerCase() || \"\").includes(searchTerm.toLowerCase()) ||\n          (d.license_number?.toLowerCase() || \"\").includes(searchTerm.toLowerCase())\n      );\n    }\n\n    setFilteredDrivers(filtered);\n  }, [searchTerm, drivers]);\n\n  const handleAddSuccess = () => {\n    setShowAddModal(false);\n    fetchDrivers();\n  };\n\n  const handleAddDriver = async (formData: any) => {\n    if (!user) return;\n\n    // Get company_id\n    const { data: profile } = await supabase\n      .from('profiles')\n      .select('company_id')\n      .eq('id', user.id)\n      .maybeSingle();\n\n    const companyId = profile?.company_id ?? user.id;\n\n    const { error } = await supabase\n      .from('drivers')\n      .insert([\n        {\n          ...formData,\n          user_id: user.id,\n          company_id: companyId,\n        },\n      ]);\n\n    if (!error) {\n      fetchDrivers();\n    }\n  };\n\n  const handleDelete = async (driverId: string) => {\n    if (!user) return;\n\n    const { error } = await supabase\n      .from('drivers')\n      .delete()\n      .eq('id', driverId)\n      .eq('user_id', user.id);\n\n    if (!error) {\n      fetchDrivers();\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"p-8\">\n        <div className=\"mb-8\">\n          <div className=\"h-8 w-48 bg-slate-700 rounded animate-pulse\" />\n        </div>\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden\">\n          {[1, 2, 3, 4, 5].map((i) => (\n            <TableRowSkeleton key={i} />\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      <div className=\"p-8\">\n        <div className=\"flex items-center justify-between mb-8\">\n          <h1 className=\"text-3xl font-bold text-white\">Vehicle Owners</h1>\n          <button\n            onClick={() => setShowAddModal(true)}\n            className=\"px-6 py-3 bg-blue-500 text-white font-medium rounded-lg hover:bg-blue-600 transition-colors\"\n          >\n            + Add Owner\n          </button>\n        </div>\n\n        {/* Search */}\n        <div className=\"mb-6\">\n          <input\n            type=\"text\"\n            placeholder=\"Search vehicle owners by name, phone, license...\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            className=\"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-blue-500\"\n          />\n        </div>\n\n        {/* Drivers List */}\n        <div className=\"space-y-3\">\n          {filteredDrivers.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <p className=\"text-slate-400 text-lg\">No vehicle owners found</p>\n            </div>\n          ) : (\n            filteredDrivers.map((driver) => (\n              <div\n                key={driver.id}\n                className=\"bg-slate-800 border border-slate-700 rounded-xl p-6 hover:border-slate-600 transition-colors\"\n              >\n                <div className=\"flex items-start justify-between mb-4\">\n                  <div\n                    className=\"flex-1 cursor-pointer\"\n                    onClick={() => router.push(`/owners/${driver.id}`)}\n                  >\n                    <h3 className=\"text-lg font-bold text-white\">\n                      {driver.full_name}\n                    </h3>\n                    <p className=\"text-sm text-slate-500\">\n                      {driver.license_number || 'No license'}\n                    </p>\n                  </div>\n                  <div className=\"flex gap-2 ml-4\">\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        handleDelete(driver.id);\n                      }}\n                      className=\"p-2 bg-red-500/10 text-red-400 rounded-lg hover:bg-red-500/20 transition-colors\"\n                      title=\"Delete\"\n                    >\n                      <Trash2 className=\"w-4 h-4\" />\n                    </button>\n                  </div>\n                </div>\n                <div className=\"flex gap-4 text-sm text-slate-400\">\n                  <span>ðŸ“± {driver.phone_number}</span>\n                  <span>ðŸ†” {driver.license_number || 'No license'}</span>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n\n        {showAddModal && (\n          <AddDriverModal\n            onClose={() => setShowAddModal(false)}\n            onSuccess={handleAddSuccess}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}