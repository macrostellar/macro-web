{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/sarahasif/Documents/Software%20Codes/my-tracking%20app/app/%28dashboard%29/layout.tsx"],"sourcesContent":["\"use client\";\n\nimport { ReactNode, useEffect, useState } from \"react\";\nimport {\n  LayoutDashboard,\n  Car,\n  AlertCircle,\n  FileText,\n  Settings,\n  LogOut,\n  Bus,\n  Locate,\n  Users,\n  Building2,\n  Map,\n  Bell,\n  Shield,\n  Loader2,\n} from \"lucide-react\";\n\nimport { useAuth } from \"../../contexts/AuthContext\";\nimport { useRouter, usePathname } from \"next/navigation\";\n\nexport default function DashboardLayout({ children }: { children: ReactNode }) {\n  const { signOut, role, isSuperAdmin, isOwner, profile, loading, user } = useAuth();\n  const router = useRouter();\n  const pathname = usePathname();\n  const [isSigningOut, setIsSigningOut] = useState(false);\n\n  // Redirect to signin if not authenticated\n  useEffect(() => {\n    if (!loading && !user) {\n      router.replace(\"/signin\");\n    }\n  }, [loading, user, router]);\n\n  const handleSignOut = async () => {\n    if (isSigningOut) return; // Prevent double clicks\n    setIsSigningOut(true);\n    try {\n      await signOut();\n      router.replace(\"/signin\");\n    } catch (error) {\n      console.error(\"Sign out error:\", error);\n      setIsSigningOut(false);\n    }\n  };\n\n  // Base nav items for all users\n  const baseNavItems = [\n    { icon: LayoutDashboard, label: \"Dashboard\", path: \"/dashboard\" },\n    { icon: Locate, label: \"Live Tracking\", path: \"/live-tracking\" },\n  ];\n\n  // Owner and Super Admin nav items\n  const ownerNavItems = [\n    { icon: Bus, label: \"My Vehicles\", path: \"/vehicles\" },\n    { icon: Users, label: \"Vehicle Owners\", path: \"/owners\" },\n    { icon: Map, label: \"Geofences\", path: \"/geofences\" },\n    { icon: AlertCircle, label: \"Alerts\", path: \"/alerts\" },\n    { icon: FileText, label: \"Reports\", path: \"/reports\" },\n  ];\n\n  // Super Admin only items\n  const adminNavItems = [\n    { icon: Car, label: \"All Vehicles\", path: \"/global-vehicles\" },\n    { icon: Building2, label: \"Companies\", path: \"/companies\" },\n    { icon: Shield, label: \"User Management\", path: \"/users\" },\n  ];\n\n  // Settings available to all\n  const settingsItem = { icon: Settings, label: \"Settings\", path: \"/settings\" };\n\n  // Build nav items based on role\n  let navItems = [...baseNavItems];\n  \n  if (isOwner || isSuperAdmin) {\n    navItems = [...navItems, ...ownerNavItems];\n  }\n  \n  if (isSuperAdmin) {\n    navItems = [...navItems, ...adminNavItems];\n  }\n  \n  navItems.push(settingsItem);\n\n  // Show loading spinner while auth is loading or signing out\n  if (loading || isSigningOut) {\n    return (\n      <div className=\"min-h-screen bg-slate-900 flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 text-blue-400 animate-spin\" />\n      </div>\n    );\n  }\n\n  // Don't render if not authenticated\n  if (!user) {\n    return null;\n  }\n\n  // Get role badge color\n  const getRoleBadgeColor = () => {\n    switch (role) {\n      case 'super_admin':\n        return 'bg-red-500/20 text-red-400 border-red-500/30';\n      case 'owner':\n        return 'bg-blue-500/20 text-blue-400 border-blue-500/30';\n      case 'driver':\n        return 'bg-green-500/20 text-green-400 border-green-500/30';\n      default:\n        return 'bg-slate-500/20 text-slate-400 border-slate-500/30';\n    }\n  };\n\n  const getRoleLabel = () => {\n    switch (role) {\n      case 'super_admin':\n        return 'Super Admin';\n      case 'owner':\n        return 'Owner';\n      case 'driver':\n        return 'Driver';\n      default:\n        return 'User';\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-900 flex\">\n      <div className=\"w-64 bg-slate-800 border-r border-slate-700 flex flex-col fixed left-0 top-0 h-screen\">\n        <div className=\"flex flex-col items-center p-4 gap-1\">\n          <img\n            src=\"https://rppnet.com/wp-content/uploads/2026/01/full_logo_white_version.png\"\n            alt=\"Macrostellar Logo\"\n            className=\"h-full w-full\"\n          />\n        </div>\n\n        {/* User info section */}\n        <div className=\"px-4 py-3 border-b border-slate-700\">\n          <p className=\"text-white font-medium text-sm truncate\">\n            {profile?.full_name || profile?.email || 'User'}\n          </p>\n          <span className={`inline-block mt-1 px-2 py-0.5 text-xs font-medium rounded-full border ${getRoleBadgeColor()}`}>\n            {getRoleLabel()}\n          </span>\n        </div>\n\n        <nav className=\"flex-1 p-4 space-y-1 overflow-y-auto\">\n          {navItems.map((item) => {\n            const Icon = item.icon;\n            const isActive = pathname === item.path;\n\n            return (\n              <button\n                key={item.path}\n                onClick={() => router.push(item.path)}\n                className={`w-full flex items-center gap-3 px-4 py-2.5 rounded-lg transition-colors ${\n                  isActive\n                    ? \"bg-blue-500/10 text-blue-400\"\n                    : \"text-slate-400 hover:text-white hover:bg-slate-700/50\"\n                }`}\n              >\n                <Icon className=\"w-5 h-5\" />\n                <span className=\"font-medium text-sm\">{item.label}</span>\n              </button>\n            );\n          })}\n        </nav>\n\n        <div className=\"p-4 border-t border-slate-700\">\n          <button\n            onClick={handleSignOut}\n            disabled={isSigningOut}\n            className=\"w-full flex items-center gap-3 px-4 py-2.5 text-slate-400 hover:text-white hover:bg-slate-700/50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {isSigningOut ? (\n              <Loader2 className=\"w-5 h-5 animate-spin\" />\n            ) : (\n              <LogOut className=\"w-5 h-5\" />\n            )}\n            <span className=\"font-medium text-sm\">{isSigningOut ? \"Signing out...\" : \"Sign Out\"}</span>\n          </button>\n        </div>\n      </div>\n\n      <div className=\"ml-64 flex-1 min-h-screen overflow-y-auto\">\n        {children}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiBA;AACA;AArBA;;;;;;AAuBe,SAAS,gBAAgB,EAAE,QAAQ,EAA2B;IAC3E,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,YAAY,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,IAAA,mIAAO;IAChF,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,WAAW,IAAA,iJAAW;IAC5B,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IAEjD,0CAA0C;IAC1C,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,WAAW,CAAC,MAAM;YACrB,OAAO,OAAO,CAAC;QACjB;IACF,GAAG;QAAC;QAAS;QAAM;KAAO;IAE1B,MAAM,gBAAgB;QACpB,IAAI,cAAc,QAAQ,wBAAwB;QAClD,gBAAgB;QAChB,IAAI;YACF,MAAM;YACN,OAAO,OAAO,CAAC;QACjB,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,mBAAmB;YACjC,gBAAgB;QAClB;IACF;IAEA,+BAA+B;IAC/B,MAAM,eAAe;QACnB;YAAE,MAAM,+OAAe;YAAE,OAAO;YAAa,MAAM;QAAa;QAChE;YAAE,MAAM,gNAAM;YAAE,OAAO;YAAiB,MAAM;QAAiB;KAChE;IAED,kCAAkC;IAClC,MAAM,gBAAgB;QACpB;YAAE,MAAM,uMAAG;YAAE,OAAO;YAAe,MAAM;QAAY;QACrD;YAAE,MAAM,6MAAK;YAAE,OAAO;YAAkB,MAAM;QAAU;QACxD;YAAE,MAAM,uMAAG;YAAE,OAAO;YAAa,MAAM;QAAa;QACpD;YAAE,MAAM,mOAAW;YAAE,OAAO;YAAU,MAAM;QAAU;QACtD;YAAE,MAAM,0NAAQ;YAAE,OAAO;YAAW,MAAM;QAAW;KACtD;IAED,yBAAyB;IACzB,MAAM,gBAAgB;QACpB;YAAE,MAAM,uMAAG;YAAE,OAAO;YAAgB,MAAM;QAAmB;QAC7D;YAAE,MAAM,6NAAS;YAAE,OAAO;YAAa,MAAM;QAAa;QAC1D;YAAE,MAAM,gNAAM;YAAE,OAAO;YAAmB,MAAM;QAAS;KAC1D;IAED,4BAA4B;IAC5B,MAAM,eAAe;QAAE,MAAM,sNAAQ;QAAE,OAAO;QAAY,MAAM;IAAY;IAE5E,gCAAgC;IAChC,IAAI,WAAW;WAAI;KAAa;IAEhC,IAAI,WAAW,cAAc;QAC3B,WAAW;eAAI;eAAa;SAAc;IAC5C;IAEA,IAAI,cAAc;QAChB,WAAW;eAAI;eAAa;SAAc;IAC5C;IAEA,SAAS,IAAI,CAAC;IAEd,4DAA4D;IAC5D,IAAI,WAAW,cAAc;QAC3B,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC,4NAAO;gBAAC,WAAU;;;;;;;;;;;IAGzB;IAEA,oCAAoC;IACpC,IAAI,CAAC,MAAM;QACT,OAAO;IACT;IAEA,uBAAuB;IACvB,MAAM,oBAAoB;QACxB,OAAQ;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF;IAEA,MAAM,eAAe;QACnB,OAAQ;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BACC,KAAI;4BACJ,KAAI;4BACJ,WAAU;;;;;;;;;;;kCAKd,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAE,WAAU;0CACV,SAAS,aAAa,SAAS,SAAS;;;;;;0CAE3C,8OAAC;gCAAK,WAAW,CAAC,sEAAsE,EAAE,qBAAqB;0CAC5G;;;;;;;;;;;;kCAIL,8OAAC;wBAAI,WAAU;kCACZ,SAAS,GAAG,CAAC,CAAC;4BACb,MAAM,OAAO,KAAK,IAAI;4BACtB,MAAM,WAAW,aAAa,KAAK,IAAI;4BAEvC,qBACE,8OAAC;gCAEC,SAAS,IAAM,OAAO,IAAI,CAAC,KAAK,IAAI;gCACpC,WAAW,CAAC,wEAAwE,EAClF,WACI,iCACA,yDACJ;;kDAEF,8OAAC;wCAAK,WAAU;;;;;;kDAChB,8OAAC;wCAAK,WAAU;kDAAuB,KAAK,KAAK;;;;;;;+BAT5C,KAAK,IAAI;;;;;wBAYpB;;;;;;kCAGF,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BACC,SAAS;4BACT,UAAU;4BACV,WAAU;;gCAET,6BACC,8OAAC,4NAAO;oCAAC,WAAU;;;;;yDAEnB,8OAAC,oNAAM;oCAAC,WAAU;;;;;;8CAEpB,8OAAC;oCAAK,WAAU;8CAAuB,eAAe,mBAAmB;;;;;;;;;;;;;;;;;;;;;;;0BAK/E,8OAAC;gBAAI,WAAU;0BACZ;;;;;;;;;;;;AAIT"}}]
}